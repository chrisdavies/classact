var app=function(){var e={ngRoute:!0,ngResource:!0};return{module:function(t){return e[t]?angular.module(t):(e[t]=!0,angular.module(t,[]))},initialize:function(){angular.module("app",Object.keys(e)).config(["$routeProvider",function(e){e.otherwise({controller:"Error404Ctrl",templateUrl:"errors/404/error-404.html"})}])}}}();app.module("appAssignments").config(["$routeProvider",function(e){var t={templateUrl:"assignments/assignments.html",controller:"AssignmentsCtrl",resolve:{usernames:["StudentsStore",function(e){return e.loadUsernames()}]}};e.when("/assignments/:assignment",t),e.when("/assignments",t)}]).controller("AssignmentsCtrl",["$scope","Students","usernames","Repos","$q","$log","$routeParams","$location",function(e,t,n,r,s,u,o,a){function c(){t.query({usernames:n}).then(function(e){s.all(e.map(function(e){return r.get({username:e.username,repo:i.name}).then(function(t){return e.repo=t,e}).catch(function(t){return u.log(t),e})})).then(function(e){l.students=e})})}var i=e.assignment={name:o.assignment||"","goto":function(){a.path("/assignments/"+i.name)}},l=e.studentInfo={students:[]};i.name&&c()}]),app.module("directives").directive("focusOn",function(){return function(e,t,n){e.$on(n.focusOn,function(){t[0].focus()})}}),app.module("services").factory("LocalStore",["$q",function(e){var t={save:function(t,n){return e(function(e,r){try{localStorage.setItem(t,JSON.stringify(n)),e(n)}catch(s){r(s)}})},load:function(t){return e(function(e,n){try{var r=JSON.parse(localStorage.getItem(t));return r?e(r):n(t)}catch(s){n(s)}})}};return t}]),app.module("services").factory("Repos",["$resource","$q",function(e){var t=e("https://api.github.com/repos/:username/:repo");return{get:function(e){return t.get(e).$promise.then(function(t){return{hasPages:t.has_pages,htmlUrl:t.html_url,ghPagesUrl:"http://"+e.username+".github.io/"+e.repo}})}}}]),app.module("services").factory("Students",["$resource","$q","$log",function(e,t,n){var r=e("https://api.github.com/users/:username");return r.query=function(e){return t.all((e.usernames||[]).map(function(e){return r.get({username:e}).$promise.then(function(e){return{name:e.name,username:e.login,htmlUrl:e.html_url,avatarUrl:e.avatar_url}}).catch(function(t){return n.log(t),{login:e}})}))},r.events=function(t){return e("https://api.github.com/users/:username/events").query(t).$promise.then(function(e){return e.map(function(e){return{createdAt:e.created_at}})})},r}]),app.module("services").factory("StudentsStore",["LocalStore","$log",function(e,t){var n="studentInfo.usernames",r={saveUsernames:function(t){return e.save(n,t)},loadUsernames:function(){return e.load(n).catch(function(e){return t.log(e),[]})}};return r}]),app.module("factories").factory("StringUtil",function(){return{startsWith:function(e,t){return e=e||"",e.slice(0,t.length)===t}}}),app.module("appErrors").controller("Error404Ctrl",["$scope","$location",function(e,t){e.message="Could not find: "+t.url()}]),app.module("master").controller("MainNavCtrl",["$scope","$document","$location","StringUtil",function(e,t,n,r){t.prop("title","TIYGH"),e.isActive=function(e){return"/"===e?"/"===n.path():r.startsWith(n.path(),e)}}]),app.module("directives").directive("captionedTable",function(){return{restrict:"E",transclude:!0,replace:!0,scope:{cols:"="},template:'<ul class="captioned-table"><li class="captioned-table-header-row"><span class="captioned-table-header-cell" ng-repeat="col in cols">{{col}}</span></li></ul>',compile:function(e,t,n){return function(t){n(t.$parent,function(t){e.append(t)})}}}}),app.module("directives").directive("studentProfile",function(){return{restrict:"E",replace:!0,templateUrl:"shared/student-profile/student-profile.html",scope:{student:"="}}}),app.module("appStats").config(["$routeProvider",function(e){var t={templateUrl:"stats/stats.html",controller:"StatsCtrl",resolve:{students:["StudentsStore","Students","$log","$q",function(e,t,n,r){return e.loadUsernames().then(function(e){return t.query({usernames:e})}).then(function(e){return r.all(e.map(function(e){return t.events(e).then(function(t){return e.events=t,e.latestEvent=t.length?t[0]:void 0,e}).catch(function(t){return n.log(t),e})}))})}]}};e.when("/",t),e.when("/stats",t)}]).controller("StatsCtrl",["$scope","students",function(e,t){e.studentInfo={students:t}}]),app.module("appStudents").config(["$routeProvider",function(e){e.when("/students",{templateUrl:"students/students.html",controller:"StudentsCtrl",resolve:{usernames:["StudentsStore",function(e){return e.loadUsernames()}]}})}]).controller("StudentsCtrl",["$scope","$log","StudentsStore","Students","usernames",function(e,t,n,r,s){e.studentInfo={usernames:s,students:[]},e.$watch("studentInfo.usernames",function(){return r.query({usernames:e.studentInfo.usernames}).then(function(t){return e.studentInfo.students=t,n.saveUsernames(e.studentInfo.usernames)})},!0),e.removeStudent=function(t){e.studentInfo.usernames=e.studentInfo.usernames.filter(function(e){return e!==t.username})}}]).controller("AddStudentCtrl",["$scope","Students",function(e){e.username="",e.addStudent=function(){e.studentInfo.usernames.some(function(t){return t===e.username})||e.studentInfo.usernames.push(e.username),e.username="",e.$emit("username-added")}}]);